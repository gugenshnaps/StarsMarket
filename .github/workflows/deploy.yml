name: Deploy to GitHub Pages

on:
  push:
    branches:
      - main
      - master

permissions:
  contents: write

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Create config.js
        run: |
          echo "Creating config.js..."
          echo "Content will be:"
          echo "window.CONFIG = {"
          echo "  TELEGRAM_BOT_TOKEN: \"${{ secrets.TELEGRAM_BOT_TOKEN }}\","
          echo "  TELEGRAM_CHANNEL_ID: \"${{ secrets.TELEGRAM_CHANNEL_ID }}\","
          echo "  API_URL: \"https://api.telegram.org/bot\""
          echo "};"
          
          # Create the actual file
          cat > config.js << EOL
          window.CONFIG = {
            TELEGRAM_BOT_TOKEN: "${{ secrets.TELEGRAM_BOT_TOKEN }}",
            TELEGRAM_CHANNEL_ID: "${{ secrets.TELEGRAM_CHANNEL_ID }}",
            API_URL: "https://api.telegram.org/bot"
          };
          EOL
          
          echo "config.js created. File exists:"
          ls -l config.js
          
          echo "File contents:"
          cat config.js
          
          echo "File permissions:"
          stat config.js
          
          echo "Directory contents:"
          ls -la

      - name: Deploy to GitHub Pages
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          branch: gh-pages
          folder: .
          clean: true
